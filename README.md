# floorplan-test-analyzer
Проект для автоматического извлечения стен из изображений планов квартир

Этот скрипт анализирует изображения планов квартир и извлекает информацию о расположении стен в виде структурированных данных (JSON).

## Основные технологии:
- **Python 3.11** - версия языка.
- **OpenCV** - для работы с изображениями и визуализации результатов.
- **Requests** - для взаимодействия с API.
- **Pydantic** - для валидации данных и управления конфигурацией.

## Этапы пайплайна обработки

1. **Чтение изображения** - надежное чтение с обработкой Unicode-путей
2. **Детекция объектов** - отправка изображения в Roboflow API для получения предсказаний
3. **Фильтрация результатов** - отбор только детекций класса "wall" с confidence > порога
4. **Преобразование в геометрию стен** - применение эвристик для конвертации bbox в линии
5. **Визуализация результатов** - создание отладочного изображения с нарисованными стенами
6. **Формирование JSON** - структурирование результатов в требуемом формате
7. **Сохранение результатов** - запись JSON и отладочных изображений

### Используемые модели:
- **Roboflow API** - был выбран для быстрой демонстрации. Модель [cubicasa5k-2](https://universe.roboflow.com/floorplan-recognition/cubicasa5k-2-qpmsa/model/6). Из плюсов: хорошо читает стены, есть варианты включения door и window.

### Слабые места реализации:
1. **Зависимость от API** - лучше обучить модель локально с дополнительными данными.
2. **Ограниченные эвристики** - текущий алгоритм преобразования bbox в линии может не справляться со сложными конфигурациями стен.
3. **Отсутствие постобработки** - нет алгоритмов для объединения близко расположенных линий или коррекции геометрии.
4. **Нет обработки перспективы** - не выполняется коррекция искажений при фотографировании планов под углом.

### Как запустить?

```bash
git clone <repository-url>
cd floorplan-analyzer
python -m venv venv

# Для Windows:
venv\Scripts\activate

# Для Linux/Mac:
source venv/bin/activate

pip install -r requirements.txt
```

Далее в config/settings.py укажите API_KEY и PROXY_URL (если сайт недоступен из вашего региона).

```bash
python main.py
```